##union后的dev_id总量为：657749819
# print(610366192+47383627)
# print(5363080-2150356)
# print(6113161560/1222632312)
# print(618489015-617703078)
#       10000000
# print(617703078/785937)
#0706 1：785
#1106 未登陆量：664249648   总数据量：665131235
# print(6116535075-6116243210)  #登陆数量：881587
# print(291865+0.0025*6116243210)
# print(15292954/291865)
# print(291865+15292954)
import pandas as pd
df = pd.DataFrame({'Animal': ['Falconcc', 'Falcondd',
                              'Parrot', 'Parrot'],
                    'Max Speed': [380., 370., 24., 26.]})
print(df)
for a,b in df.groupby('Animal'):
    if a=='Falcon':
        b.to_csv('./test.csv')


# col_mappings = {
#           'identifier': '[id_col]',
#           'time': '[time_col]',
#           'outputs': '[target_col]',
#           'inputs': 'input_cols'
#       }
# for k in col_mappings:
#     cols=col_mappings[k]
#     print(k,cols)

import numpy as np
import pandas as pd
x=[[ 0.23960418]
 ,[-0.32552831]
 ,[-0.60045763]
 ,[-0.61573148]
 ,[-0.38662371]
 ,[ 0.02577026]
 ,[ 0.04104412]
 ,[-0.06587284]
 ,[ 0.08686567]
 ,[ 0.48398579]
 ,[ 0.40761654]
 ,[ 0.71309356]
 ,[ 0.75891511]
 ,[-0.49354067]
 ,[-0.09642054]
 ,[ 0.30069958]
 ,[-0.08114669]
 ,[-0.32552831]
 ,[-0.15751595]
 ,[ 1.00329673]
 ,[ 1.27822605]
 ,[ 1.23240449]
 ,[ 1.27822605]
 ,[ 1.00329673]
 ,[ 0.77418896]
 ,[ 0.43816424]
 ,[ 0.16323492]
 ,[ 0.04104412]
 ,[ 0.30069958]
 ,[ 0.62145045]
 ,[ 0.69781971]
 ,[ 0.13268722]
 ,[ 0.31597343]
 ,[ 0.39234269]
 ,[ 0.13268722]
 ,[ 0.40761654]
 ,[ 0.45343809]
 ,[-0.32552831]
 ,[ 0.11741337]
,[ 0.31597343]
,[-0.11169439]
,[-0.2644329 ]
,[ 0.07159182]
,[ 0.36179499]
,[ 0.39234269]
,[ 0.13268722]
,[ 0.08686567]
,[-0.41717141]
,[-0.75319614]
,[-0.90593465]
,[-1.16559011]
 ,[-1.21141167]
 ,[-0.96703005]
 ,[-0.58518378]
 ,[-0.53936222]
 ,[-1.07394701]
 ,[-1.15031626]
 ,[-0.52408837]
 ,[-0.75319614]
 ,[-0.47826682]
 ,[-0.2644329 ]
 ,[-0.49354067]
 ,[-0.09642054]
 ,[ 0.27015188]
 ,[-0.05059899]
 ,[-0.38662371]
 ,[-0.38662371]
 ,[ 0.62145045]
 ,[ 0.56035505]
 ,[ 0.86583207]
 ,[ 0.40761654]
 ,[ 0.31597343]
 ,[-0.18806365]
 ,[-0.38662371]
 ,[-0.50881452]
 ,[-0.55463607]
 ,[-0.15751595]
 ,[ 0.05631797]
 ,[ 0.14796107]
 ,[-0.49354067]
 ,[-0.9212085 ]
 ,[-0.58518378]
 ,[-0.05059899]
 ,[-0.08114669]
 ,[ 0.13268722]
 ,[-0.06587284]
 ,[-0.08114669]
 ,[ 0.56035505]
 ,[ 0.02577026]
 ,[-0.38662371]
 ,[-0.29498061]
 ,[ 0.14796107]
 ,[-0.12696825]
 ,[ 0.5450812 ]
 ,[ 0.52980735]
 ,[ 0.28542573]
 ,[-0.03532514]
 ,[-0.21861135]
 ,[-0.47826682]
 ,[-0.60045763]
 ,[-0.38662371]
 ,[ 0.05631797]
 ,[ 0.10213952]
 ,[-0.41717141]
 ,[-0.06587284]
 ,[ 0.5145335 ]
 ,[ 0.42289039]
 ,[ 0.5450812 ]
 ,[ 1.01857058]
 ,[ 0.46871194]
 ,[ 0.85055822]
 ,[ 1.03384443]
 ,[ 1.06439213]
 ,[ 0.59090275]
 ,[ 0.83528437]
 ,[ 1.17130909]
 ,[ 0.6061766 ]
 ,[ 0.69781971]
 ,[ 0.05631797]
 ,[-0.15751595]
 ,[-0.58518378]
 ,[-0.70737458]
 ,[-1.02812545]
 ,[-1.18086396]
 ,[-1.0128516 ]
 ,[-0.52408837]
 ,[-0.50881452]
 ,[-1.04339931]
 ,[-0.52408837]
 ,[ 0.13268722]
 ,[ 0.33124728]
 ,[ 0.86583207]
 ,[ 1.23240449]
 ,[ 0.31597343]
 ,[ 0.42289039]
 ,[ 1.07966598]
 ,[ 1.09493983]
 ,[ 0.22433033]
 ,[ 0.27015188]
 ,[ 0.45343809]
 ,[ 0.23960418]
 ,[ 0.27015188]
 ,[-0.2033375 ]
 ,[-0.2338852 ]
 ,[-0.72264843]
 ,[-0.93648235]
 ,[-1.13504241]
 ,[-1.19613782]
 ,[-1.02812545]
 ,[-0.73792229]
 ,[-0.66155303]
 ,[-0.60045763]
 ,[-0.86011309]
 ,[-0.96703005]
 ,[-0.86011309]
 ,[-0.82956539]
 ,[-0.55463607]
 ,[-0.70737458]
 ,[-0.73792229]
 ,[-0.87538694]
 ,[-1.07394701]
 ,[-1.07394701]
 ,[-0.9823039 ]
 ,[-0.75319614]
 ,[-0.35607601]
 ,[ 0.36179499]
 ,[-0.03532514]
 ,[-0.37134986]
 ,[-0.82956539]
 ,[-0.8906608 ]
 ,[-1.10449471]
 ,[-1.24195937]
 ,[-1.04339931]
 ,[-0.66155303]
 ,[-0.52408837]
 ,[-1.16559011]
 ,[-0.67682688]
 ,[-0.46299297]
 ,[-0.29498061]
 ,[ 0.04104412]
 ,[ 0.27015188]
 ,[ 0.08686567]
 ,[-0.05059899]
 ,[ 0.6367243 ]
 ,[ 0.39234269]
 ,[ 0.45343809]
 ,[ 1.33932145]
 ,[ 1.82808468]
 ,[ 2.14883555]
 ,[ 2.28630021]
 ,[ 1.91972779]
 ,[ 1.75171543]
 ,[ 0.66727201]
 ,[ 0.33124728]
 ,[ 0.08686567]
 ,[-0.00477744]
 ,[ 0.27015188]
 ,[ 0.65199816]
 ,[ 0.66727201]
 ,[-0.00477744]
 ,[ 0.40761654]
 ,[ 0.85055822]
 ,[ 1.2629522 ]
 ,[ 1.11021369]
 ,[ 0.89637977]
 ,[ 0.86583207]
 ,[ 0.69781971]
 ,[ 1.385143  ]
 ,[ 1.49205996]
 ,[ 1.36986915]
 ,[ 1.75171543]
 ,[ 2.0419186 ]
 ,[ 1.20185679]
 ,[ 0.85055822]
 ,[ 0.71309356]
 ,[ 0.5145335 ]
 ,[ 0.04104412]
 ,[-0.18806365]
 ,[-0.38662371]
 ,[-0.44771912]
 ,[-0.2644329 ]
 ,[ 0.30069958]
 ,[ 0.30069958]
 ,[-0.1727898 ]
 ,[ 0.14796107]
 ,[ 0.46871194]
 ,[ 0.62145045]
 ,[ 1.36986915]
 ,[ 0.94220132]
 ,[ 0.78946281]
 ,[ 1.03384443]
 ,[ 1.79753698]
 ,[ 1.09493983]
 ,[ 0.88110592]
 ,[ 0.92692747]
 ,[ 1.2934999 ]
 ,[ 0.89637977]
 ,[ 0.42289039]
 ,[ 0.20905648]
 ,[-0.31025446]
 ,[-0.70737458]
 ,[-0.79901769]
 ,[-0.96703005]
 ,[-1.08922086]
 ,[-0.96703005]
 ,[-0.46299297]
 ,[-0.41717141]
 ,[-0.99757775]
 ,[-0.41717141]
 ,[ 0.20905648]
 ,[ 1.01857058]
 ,[ 1.56842922]
 ,[ 0.45343809]
 ,[-0.05059899]
 ,[ 0.91165362]
 ,[ 1.24767834]
 ,[ 0.66727201]
 ,[ 0.37706884]
 ,[ 0.23960418]
 ,[ 0.6061766 ]
 ,[ 0.37706884]
 ,[ 0.45343809]
 ,[ 0.10213952]
 ,[-0.1422421 ]
 ,[-0.67682688]
 ,[-0.82956539]
 ,[-1.10449471]
 ,[-1.16559011]
 ,[-0.96703005]
 ,[-0.56990992]
 ,[-0.15751595]
 ,[-0.9212085 ]
 ,[-0.55463607]
 ,[ 0.34652114]
 ,[ 0.6367243 ]
 ,[ 0.74364126]
 ,[ 0.19378263]
 ,[-0.03532514]
 ,[ 0.6367243 ]
 ,[ 1.24767834]
 ,[ 0.56035505]
 ,[-0.09642054]
 ,[ 0.27015188]
 ,[ 0.74364126]
 ,[ 0.52980735]
 ,[ 0.36179499]
 ,[ 0.42289039]
 ,[-0.05059899]
 ,[-0.43244527]
 ,[-0.73792229]
 ,[-0.96703005]
 ,[-1.10449471]
 ,[-0.86011309]
 ,[-0.38662371]
 ,[-0.1727898 ]
 ,[-1.07394701]
 ,[-0.8906608 ]
 ,[-0.18806365]
 ,[ 0.16323492]
 ,[ 0.11741337]
 ,[-0.06587284]
 ,[-0.2033375 ]
 ,[-0.2338852 ]
 ,[ 0.23960418]
 ,[-0.05059899]
 ,[-0.06587284]
 ,[-0.35607601]
 ,[-0.11169439]
,[ 0.22433033]
,[ 0.40761654]
,[ 0.25487803]
,[-0.27970676]
,[-0.53936222]
,[-0.78374384]
,[-0.90593465]
,[-1.04339931]
,[-0.84483924]
,[-0.64627918]
,[-0.40189756]
,[-0.73792229]
,[-1.0128516 ]
,[-0.82956539]
,[-0.29498061]
,[-0.1422421 ]
,[ 0.04104412]
,[-0.24915905]
,[-0.1727898 ]
,[-0.46299297]
,[-1.07394701]
,[-0.96703005]
,[-1.0128516 ]
 ,[-0.58518378]
 ,[-0.1422421 ]
 ,[ 0.10213952]
 ,[-0.11169439]
 ,[-0.47826682]]
x=np.array(x)
print(x.shape)
time_steps=336
lags=336
if time_steps >= lags:
    aa=np.stack(
            [x[i:time_steps - (lags - 1) + i, :] for i in range(lags)], axis=1)
    print(aa.shape)
